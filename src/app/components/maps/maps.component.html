<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
<link href="https://fonts.googleapis.com/css?family=Luckiest+Guy" rel="stylesheet">

<div class="row">
    <div class="col-lg-3 viajes form-group">
        <h3>Viajes</h3>
        <form #mapsForm="ngForm" (ngSubmit)="onSubmit(mapsForm)" class="col-lg-12">
            <p>
                <label>Nombre de tu viaje</label>
                <input type="text" class="form-control" name="nombre" #name="ngModel"  [(ngModel)]="travel.name" id="nameMap" ng-change="updateInputs()"/>
            </p>
            <p>
                <!-- Sin terminar -->
                <label>Fecha</label>
                <input type="date" class="form-control" name="fecha" #fecha="ngModel" [(ngModel)]="travel.date"  id="dateMap" value="{{travel.date}}"/>
            </p>

            <p>
                <label>Descripcion</label>
                <textarea name="descripcion" #description="ngModel" class="form-control" [(ngModel)]="travel.description"  id="desMap" value="{{travel.description}}" required></textarea>
            </p>
            <div *ngIf="travel.status">
                <p>
                    <label>Estado</label>
                    <input id="checkBox" type="checkbox" name="estado" #status="ngModel" class="form-control" [(ngModel)]="travel.status" id="statusMap" />
                </p>
            </div>
            <div *ngIf="!travel._id">
                <input type="submit" value="Confirmar" class="btn btn-success" />
            </div>
            <div *ngIf="travel._id">
                <input type="button" value="Actualizar" class="btn btn-danger"  (click)="updateTravels()"/>
            </div>
            <div *ngIf="travel._id">
                <input type="button" value="Actualizar" class="btn btn-danger"  (click)="deleteTravel()"/>
            </div>
        </form>
    </div>

    <div class="col-lg-9">
        <input type="button" value="Borrar Marcas" class="btn btn-danger"  (click)="clearMap()"/>
        <agm-map [zoom]="zoom"  [latitude]="lat" [longitude]="lng" (mapClick)="mapClicked($event)">
                    <agm-marker *ngFor="let m of markers; let i = index"
                    [label]="m.label"
                    [latitude]="m.lat"
                    [longitude]="m.lng"
                    [markerDraggable]="m.draggable" >
                    <!-- Texto de la chincheta -->
                    <agm-info-window *ngIf="m.texto">
                        <strong>{{m.texto}}</strong>
                        <br/>
                        <input type="button" value="Borrar marcador" class="btn btn-danger"  (click)="deleteMarker(i)"/>
                    </agm-info-window>
                </agm-marker>
    </agm-map>

    <div class="marcas"  *ngIf="markers == null">
        <ul *ngFor="let m of markers; let i = index" >
            <li>{{m.label}} -- {{m.texto}}</li>
        </ul>
    </div>
    <!-- Listado de todos los puntos del viaje -->
    <div class="markersViajes">
        <br/>
        <h3>Listado de puntos del viaje </h3>
        <ul class="list-group" *ngFor="let t of travel.markers; let i = index" >
            <li class="list-group-item">{{t.label}} -- {{t.texto}}</li>
        </ul>
    </div>
    <br/>
    <!-- Muestra todos los viajes -->
    <div  class="allTravels" *ngIf="travels != null">
        <h3> Todos los viajes disponibles</h3>
        <ul class="list-group" *ngFor="let t of travels.travels" >
            <div *ngIf="t.status != false">
            <li class="list-group-item">Nombre: {{t.name}}  <input type="button" value="seleccionar viaje" (click)="ngOnInit()" [routerLink]="['/viajes', t._id]"/></li>
            <li class="list-group-item">Descripcion: {{t.description}}</li>
            <li class="list-group-item"> <input type="button" value="Apuntarse viaje" (click)="saveEnroll()"/></li>
            <br/>
            </div>
        </ul>
        <div class="enrolledUsers">
            <span>Usuarios apuntados </span><input type="button" value="Actualizar" class="btn btn-danger"  (click)="getEnrolledUsers()"/>
        </div>
    </div>
</div>

</div>
